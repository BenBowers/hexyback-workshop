---
sidebar_position: 5
tags:
  - introduction
---

# Table Design

When using DynamoDB, we'll be storing all our entities in a single table.

The application requires the following three entities:

1. Borrower Profile
2. Borrowing Capacity Calculation
3. Loan Application

Let's take a look at each entity and it's attributes.

## Borrower Profile

### Attributes

| Name        | Type   | Example              | Description                                                  |
|-------------|--------|----------------------|--------------------------------------------------------------|
| pk          | string | john.doe@example.com | Primary Key: The borrower's email address                    |
| sk          | string | BORROWER             | Sort Key: The entity type (BORROWER)                         |
| creditScore | number | 500                  | Borrower's credit score. This is a number between 0 and 1000 |
| dob         | string | '1985-09-01'         | Borrower's date of birth as an ISO8061 date string           |
| email       | string | john.doe@example.com | Borrower's email address                                     |
| name        | string | John Doe             | Borrower's name                                              |

## Borrowing Capacity Calculation

### Attributes

| Name                           | Type   | Example                                                                                      | Description                                                                                                                   |
|--------------------------------|--------|----------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| pk                             | string | john.doe@example.com                                                                         | Primary Key: The borrower's email address                                                                                     |
| sk                             | string | BORROWING_CAPACITY_CALCULATION#2dd0ce10-4d28-4275-af31-b2e5edc7430a#2024-03-15T00:00:00.000Z | Sort Key: The entity type ('BORROWING_CAPACITY_CALCULATION'),  borrowingCapacityCalculationId and timestamp separated by '#'  |
| estimatedBorrowingCapacity     | number | 100000                                                                                       | The borrower's borrowing capacity. This is a number >= 0                                                                      |
| grossAnnualIncome              | number | 40000                                                                                        | The borrower's gross annual income. This is a number >= 0                                                                     |
| employmentStatus               | string | 'FULL_TIME'                                                                                  | The borrower's employment status. One of 'FULL_TIME', 'PART_TIME', 'CASUAL', 'SELF_EMPLOYED'                                  |
| borrowingCapacityCalculationId | string | '2dd0ce10-4d28-4275-af31-b2e5edc7430a'                                                       | A randomly generated V4 UUID                                                                                                  |
| timestamp                      | string | '2024-03-15T00:00:00.000Z`                                                                   | The time of calculation of the borrowing capacity. This is an ISO8061 date and time in UTC.                                   |

## Loan Application

### Attributes

| Name                  | Type   | Example                                                                        | Description                                                                                        |
|-----------------------|--------|--------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| pk                    | string | john.doe@example.com                                                           | Primary Key: The borrower's email address                                                          |
| sk                    | string | LOAN_APPLICATION#2dd0ce10-4d28-4275-af31-b2e5edc7430a#2024-03-15T00:00:00.000Z | Sort Key: The entity type ('LOAN_APPLICATION'),  loanApplicationId and timestamp separated by '#'  |
| loanApplicationStatus | string | 'APPROVED'                                                                     | The borrower's employment status. One of 'APPROVED', 'REJECTED', 'REVIEW'                          |
| creditScore           | number | 700                                                                            | Borrower's credit score. This is a number between 0 and 1000                                       |
| grossAnnualIncome     | number | 40000                                                                          | The borrower's gross annual income. This is a number >= 0                                          |
| monthlyExpenses       | number | 1560                                                                           | The borrower's monthly expenses. This is a number >= 0                                             |
| employmentStatus      | string | 'FULL_TIME'                                                                    | The borrower's employment status. One of 'FULL_TIME', 'PART_TIME', 'CASUAL', 'SELF_EMPLOYED'       |
| loanApplicationId     | string | '2dd0ce10-4d28-4275-af31-b2e5edc7430a'                                         | A randomly generated V4 UUID                                                                       |
| timestamp             | string | '2024-03-15T00:00:00.000Z`                                                     | The time of the loan application. This is an ISO8061 date and time in UTC.                         |

## Table Design

We can persist all three entities in a single table. In Hexy, the table is called `FinancialData`.

```typescript title="backend/infra/ConfigStack.ts"
import { Config, Function, StackContext, Table } from 'sst/constructs';
import { generateApiSpec } from './api-definition';

export function ConfigStack({ stack, app }: StackContext) {
  // highlight-start
  const financialDataTable = new Table(stack, 'FinancialData', {
    fields: {
      pk: 'string',
      sk: 'string',
      email: 'string',
      dob: 'string',
      creditScore: 'number',
      monthlyExpenses: 'number',
      grossAnnualIncome: 'number',
      employmentStatus: 'string',
      borrowingCapacity: 'number',
      loanApplicationStatus: 'string',
      entity: 'string',
    },
    primaryIndex: {
      partitionKey: 'pk',
      sortKey: 'sk',
    },
  });
  // highlight-end
  // ...
}
```